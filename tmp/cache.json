{"ingress-nginx-controller___FailedBuildModel":{"Message":"Failed build model due to unable to resolve at least one subnet (0 match VPC and tags)","Answer":"Kubernetes 서비스(Service) 오류 메시지에 따르면, 서비스는 \"Failed build model due to unable to resolve at least one subnet (0 match VPC and tags)\" 때문에 모델을 구축하는 데 실패했습니다. 이는 일반적으로 구성된 서비스가 AWS Elastic Load Balancer(ELB)와 통신을 시도하고 있으며, ELB가 사용할 수 있는 서브넷을 찾을 수 없기 때문에 발생하는 문제입니다.\n\nKubernetes 환경에서 자동으로 ELB를 생성하는 것은 Ingress 리소스를 통해 이루어지며, 서비스 유형이 LoadBalancer인 경우에 주로 이루어집니다. 하지만 이 경우에는 Helm을 통해 설치된 `ingress-nginx-controller` 서비스인 것으로 보입니다. Ingress-Nginx 컨트롤러는 Kubernetes 클러스터 내의 Ingress 리소스를 관리하기 위해 사용되며, 이 컨트롤러의 서비스 유형이 LoadBalancer로 설정되어 AWS의 ELB를 사용할 경우, 해당 서비스가 올바르게 VPC 내의 서브넷과 관련된 태그를 가리키고 있는지 확인해야 합니다.\n\n해결방안:\n\n1. AWS VPC와 서브넷 구성 확인:\n    - AWS 관리 콘솔에 로그인 후, VPC 대시보드에서 Kubernetes 클러스터와 연결된 VPC가 올바르게 구성되어 있는지 확인합니다.\n    - 서브넷이 적절하게 태그되었는지 확인합니다. Kubernetes는 특정 태그를 사용하여 ELB를 위한 서브넷을 식별합니다. 예를 들어, Kubernetes 1.9 부터는 `kubernetes.io/cluster/\u003ccluster-name\u003e` 태그와 `kubernetes.io/role/elb` 값이 `1`이 있는 서브넷을 ELB용으로 사용합니다.\n\n2. Ingress-nginx 컨트롤러 서비스 정의의 annotations 확인:\n    - 클러스터에 대한 kubeconfig 파일을 사용하여 Kubernetes 클러스터에 접속합니다.\n    - ingress-nginx 컨트롤러 서비스의 서비스 정의를 검토합니다. 명령어는 `kubectl get svc -n \u003cnamespace\u003e \u003cservice-name\u003e -o yaml`입니다.\n    - 서비스 정의 내의 annotations 섹션에서 ELB 관련 설정이 적절한지 확인하고 필요한 경우 수정합니다.\n\n3. IAM 권한 검토:\n    - AWS에서 클러스터 또는 Kubernetes 서비스가 ELB 리소스를 생성하고 관리할 수 있는 IAM 권한을 가지고 있는지 확인합니다.\n\n4. Ingress-nginx Helm 차트 구성 다시 검토:\n    - 사용된 Helm 차트의 값 파일(values.yaml)을 확인하여 ELB와 관련된 설정이 올바른지 검토합니다.\n\n위 단계들을 확인하고 수정한 후에는 다시 Helm 차트를 업데이트하거나, 필요한 경우 서비스를 재생성하여 문제가 해결되었는지 확인합니다.\n","Timestamp":"2023-12-08T18:13:58.177443+09:00","ErrorTime":"2023-12-08T18:10:57.556805+09:00","ErrorCount":48}}